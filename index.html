<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <meta http-equive="Pragma" content="no-cache">

  <title>Blocklords Map Editor</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="css/blog-post.css" rel="stylesheet">

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">
      <a class="navbar-brand" href="#">Blocklords map editor &ndash; a tool to define the regions neighbourhood</a>
    </div>
  </nav>

  <!-- Page Content -->
  <div class="container">

    <div class="row">

      <!-- Post Content Column -->
      <div class="col-lg-8">
        <!-- Side Widget -->
        <div class="card my-4">
          <h5 class="card-header">Graph Editor</h5>
          <div class="card-body">
            <div class="row">
              <div class="col-lg-12 graph-container pre-scrollable" >

              </div>
            </div>
            <div class="row">
              <div class="col-lg-12">
                <ul class="list-unstyled mb-0">
                  <li>
                    <p>Tip: set the background map for Graph editor at the source code!</p>
                  </li>
                  <li>
                    <p>Tip: Click on empty space to add node!</p>
                  </li>
                  <li>
                    <p>Tip: Drag from node to node to add edge!</p>
                  </li>
                  <li>
                    <p>Tip: Click/Select + Delete to delete node/edge!</p>
                  </li>
                  <li>
                    <p>Tip: Click/Select Edge + Enter to change edge's weight!</p>
                  </li>
                  <li>
                    <p>Tip: Press Ctrl to Drag node around!</p>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- Sidebar Widgets Column -->
      <div class="col-md-4">


        <!-- Side Widget -->
        <div class="card my-4">
          <h5 class="card-header">Vertices List</h5>
          <div class="card-body">
            <div class="row">
              <div class="col-lg-12 form-group">
                <textarea class="form-control" id="vertices-list">
                </textarea>
              </div>
            </div>
          </div>
        </div>
        <!-- Side Widget -->
        <div class="card my-4">
          <h5 class="card-header">Edges List</h5>
          <div class="card-body">
            <div class="row">
              <div class="col-lg-12 form-group">
                <textarea class="form-control" id="edges-list">
                </textarea>
              </div>
            </div>
          </div>
        </div>

      </div>

    </div>
    <!-- /.row -->

  </div>
  <!-- /.container -->

  <!-- Footer -->
  <footer class="py-5 bg-dark">
    <div class="container">
      <p class="m-0 text-center text-white">by Medet Ahmetson</p>
    </div>
    <!-- /.container -->
  </footer>

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="graphlib.min.js"></script>
  <script>
    var graph = new graphlib.Graph({directed: false});
    var verticesList = document.getElementById("vertices-list");
    var edgesList = document.getElementById("edges-list");

    function addNodeToGraph(node) {
      graph.setNode(node.id, node);

      reListVertices();
    }

    function addEdgeToGraph(source, destination) {
      graph.setEdge(source.id, destination.id);

      reListEdges();
    }

    function removeNodeFromGraph(node) {
      // list of shortest path with one weight
      // for each of the returned nodes, remove the edge
      //    graph.removeEdge(node.id, shortest[i]);
      graph.removeNode(node.id);
    }

    function reListVertices() {
      verticesList.innerHTML = "";
      
      for (var i=0; i<nodes.length; i++) {
        var id = nodes[i].id;
        var node = nodes[i];

        var vertex = "graph.setNode('"+id+"', "+JSON.stringify(node)+");\n";
        
        verticesList.innerHTML = verticesList.innerHTML + vertex;
      }

      verticesList.setAttribute("rows", nodes.length)
    }

    function reListEdges() {
      edgesList.innerHTML = "";
      
      for (var i=0; i<graph.edges().length; i++) {
        var edge = graph.edges()[i];

        var str = "graph.setEdge('"+edge.v+"', '"+edge.w+"');\n";
        
        edgesList.innerHTML = edgesList.innerHTML + str;
      }

      verticesList.setAttribute("rows", graph.edges().length)
    }

  </script>
  <script src="visual.js"></script>
</body>

</html>
